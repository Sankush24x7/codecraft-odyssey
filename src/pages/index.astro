---
import BaseLayout from '../layouts/BaseLayout.astro';
import '../styles/pixel-theme.css';
---

<BaseLayout title="CodeCraft Odyssey - Start Your Journey">
  <div class="theme-pixel scanlines pixel-grid-bg" style="min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px;">
    <div class="pixel-card" style="max-width: 600px; text-align: center;">
      
      <!-- Logo / Title -->
      <h1 class="mission-title" style="font-size: 28px; margin-bottom: 32px; animation: pixelFadeIn 0.5s ease-out;">
        âš”ï¸ CODECRAFT<br>ODYSSEY âš”ï¸
      </h1>

      <p style="font-size: 20px; margin-bottom: 24px; line-height: 1.6;">
        Embark on an epic journey from <span style="color: var(--pixel-primary);">Level 1</span> to <span style="color: var(--pixel-accent);">Level 100</span>
      </p>

      <p style="font-size: 18px; margin-bottom: 32px; color: var(--pixel-text-dim);">
        Master developer skills through hands-on challenges.<br>
        No boring tutorials. Just code, debug, and level up! ğŸš€
      </p>

      <!-- Player Name Input -->
      <div style="margin-bottom: 24px;">
        <label style="display: block; font-family: var(--font-pixel); font-size: 12px; margin-bottom: 8px; color: var(--pixel-accent);">
          ENTER YOUR NAME
        </label>
        <input 
          type="text" 
          id="playerName" 
          placeholder="Adventurer"
          maxlength="20"
          style="
            width: 100%;
            padding: 12px;
            font-family: var(--font-mono);
            font-size: 20px;
            background: var(--pixel-bg);
            color: var(--pixel-text);
            border: 4px solid var(--pixel-border);
            text-align: center;
          "
        />
      </div>

      <!-- Start Button -->
      <button 
        class="pixel-button" 
        id="startBtn"
        style="width: 100%; font-size: 16px; padding: 16px; margin-bottom: 16px;"
      >
        â–¶ START QUEST
      </button>

      <!-- Continue Button (shown if save exists) -->
      <button 
        class="pixel-button secondary" 
        id="continueBtn"
        style="width: 100%; font-size: 14px; padding: 12px; display: none;"
      >
        ğŸ’¾ CONTINUE
      </button>

      <!-- Stats Preview -->
      <div id="statsPreview" style="margin-top: 24px; display: none; padding: 16px; background: rgba(74, 222, 128, 0.1); border: 3px solid var(--pixel-primary);">
        <p style="font-family: var(--font-pixel); font-size: 11px; color: var(--pixel-primary);">
          SAVED PROGRESS FOUND
        </p>
        <p id="saveInfo" style="font-size: 16px; margin-top: 8px;"></p>
      </div>

      <!-- About -->
      <div style="margin-top: 32px; padding-top: 24px; border-top: 2px solid var(--pixel-border);">
        <p style="font-size: 16px; color: var(--pixel-text-dim);">
          ğŸŒ± World 1: Novice Plains (Levels 1-15)<br>
          ğŸ—ï¸ World 2: API Citadel (Levels 16-30)<br>
          ğŸ¨ World 3: Frontend Kingdom (Levels 31-50)<br>
          ğŸ” World 4: Security Fortress (Levels 51-65)<br>
          âš™ï¸ World 5: Performance Arena (Levels 66-85)<br>
          ğŸ§  World 6: Architect Summit (Levels 86-100)
        </p>
      </div>

    </div>
  </div>

  <script>
    import { getGameState } from '../scripts/gameState.js';

    const gameState = getGameState();
    const playerNameInput = document.getElementById('playerName');
    const startBtn = document.getElementById('startBtn');
    const continueBtn = document.getElementById('continueBtn');
    const statsPreview = document.getElementById('statsPreview');
    const saveInfo = document.getElementById('saveInfo');

    // Load existing save if it exists
    const currentState = gameState.get();
    if (currentState.playerId && currentState.totalXP > 0) {
      statsPreview.style.display = 'block';
      continueBtn.style.display = 'block';
      playerNameInput.value = currentState.playerName;
      
      saveInfo.textContent = `Level ${currentState.currentLevel} | ${currentState.totalXP} XP | ${currentState.completedLevels.length} Missions Complete`;
    }

    // Start new game
    startBtn.addEventListener('click', () => {
      const name = playerNameInput.value.trim() || 'Adventurer';
      
      // Reset and create new game
      gameState.reset();
      gameState.setPlayerName(name);
      
      // Redirect to world map
      window.location.href = '/map';
    });

    // Continue existing game
    continueBtn.addEventListener('click', () => {
      window.location.href = '/map';
    });

    // Enter key to start
    playerNameInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        startBtn.click();
      }
    });
  </script>
</BaseLayout>
